import{r as k,j as t}from"./index-CIuRjdGw.js";import{v as I,u as A,e as H}from"./extendable-CZ_ptkKR.js";import{C as P}from"./configfullpage-DdPJEFnB.js";import{i as F,H as K}from"./style-B0060oZX.js";import"./vis-network-DvV5Ajkb.js";const R=(w,C,z)=>{k.useEffect(()=>{const d=new I.DataSet([]),o=new I.DataSet([]),h=document.getElementById("directed"),u=document.getElementById("isWeightedGraph"),p=document.getElementById("physics");let f=p?p.checked:1,N=!!f;const c={},S=document.getElementById("mynetwork"),D={nodes:d,edges:o},B={configure:{enabled:!1},nodes:{shape:"dot",color:"#bdd482",size:40,margin:10,font:{color:"#000000",size:40,vadjust:-80,align:"center"}},edges:{smooth:f?{type:"dynamic",roundness:.5}:{type:"horizontal",roundness:0},selfReferenceSize:20},interaction:{dragNodes:!0,hover:!0},physics:{enabled:N,solver:"forceAtlas2Based",forceAtlas2Based:{springLength:200,springConstant:.02,centralGravity:.005,gravitationalConstant:-80},stabilization:{iterations:200},wind:{x:0,y:0}}},r=new I.Network(S,D,B);let E=0;d.on("*",function(){E===0&&(r.fit(),r.moveTo({scale:.7}),E=1)}),o.on("*",function(){E===0&&(r.fit(),r.moveTo({scale:.7}),E=1)});let y=0,x=[],v=[];r.on("doubleClick",function(i){if(!i.nodes.length){y++;const s=i.pointer.canvas,n={id:y,label:`${y}`,x:s.x,y:s.y};d.add(n),x.push({type:"addNode",data:n}),v=[]}});let g=[];r.on("click",function(i){if(i.nodes.length&&i.event.srcEvent.shiftKey){if(g.push(i.nodes[0]),g.length===2){const e=g[0],s=g[1],n=e===s,a=h.checked;if(n){c[e]=(c[e]||0)+1;const m=c[e];if(m>=6){const W=35+(m-5)*5,G=40+(m-5)*5,V=-80-(m-5)*10;d.update({id:e,size:W,font:{size:G,vadjust:V}})}}const l=Math.random()>.5?"curvedCCW":"curvedCW",j=Math.random()*.5+.2,b={from:e,to:s,arrows:a?"to":"",smooth:n?{type:l,roundness:j}:!0,selfReferenceSize:n?20+(c[e]-1)*10:void 0,isDirected:a};o.add(b),d.update({id:e,fixed:!1}),d.update({id:s,fixed:!1}),x.push({type:"addEdge",data:b}),v=[],g=[]}}else g=[]}),r.on("click",function(i){if(i.edges.length>0&&!window.event.shiftKey&&u.checked==!0){const e=i.edges[0],n=o.get(e).label||"",a=prompt("Nhập trọng số cho cung:",n);a!==null&&o.update({id:e,label:a,font:{size:30,align:"horizontal"}})}});function L(i,e){o.forEach(s=>{o.update({id:s.id,arrows:i?"to":"",label:e&&s.label||"",font:e?{size:30,align:"horizontal"}:{}})})}h.addEventListener("change",function(){L(h.checked,u.checked)}),u.addEventListener("change",function(){L(h.checked,u.checked)}),p.addEventListener("change",function(){f=p.checked,N=!!f,r.setOptions({physics:{enabled:N,solver:"forceAtlas2Based",forceAtlas2Based:{springLength:200,springConstant:.02,centralGravity:.005,gravitationalConstant:-80},stabilization:{iterations:200},wind:{x:0,y:0}},edges:{smooth:f?{type:"dynamic",roundness:.5}:{type:"horizontal",roundness:0}}})}),document.addEventListener("keydown",function(i){if(i.ctrlKey&&i.key==="z"){const e=x.pop();if(e){if(e.type==="addNode")d.remove(e.data.id),o.forEach(s=>{(s.from===e.data.id||s.to===e.data.id)&&o.remove(s.id)}),y--,v.push(e);else if(e.type==="addEdge"){const s=e.data;if(o.remove({id:s.id}),s.from===s.to){const n=s.from;if(c[n])if(c[n]--,c[n]<6)d.update({id:n,size:40,font:{size:40,vadjust:-80}});else{const a=35+(c[n]-5)*5,l=40+(c[n]-5)*5,j=-80-(c[n]-5)*10;d.update({id:n,size:a,font:{size:l,vadjust:j}})}}v.push(e)}}}if(i.ctrlKey&&i.key==="y"){const e=v.pop();if(e){if(e.type==="addNode")y++,d.add(e.data),x.push(e);else if(e.type==="addEdge"){const s=h.checked,n=e.data;if(n.arrows=s?"to":"",console.log(n),o.add(n),n.from===n.to){const a=n.from;c[a]=(c[a]||0)+1;const l=c[a];if(l>=6){const j=35+(l-5)*5,b=40+(l-5)*5,m=-80-(l-5)*10;d.update({id:a,size:j,font:{size:b,vadjust:m}})}}x.push(e)}}}}),document.addEventListener("keydown",function(i){i.key==="Shift"&&S.classList.add("shift-cursor")}),document.addEventListener("keyup",function(i){i.key==="Shift"&&S.classList.remove("shift-cursor")}),document.getElementById("zoomExtendsButton").addEventListener("click",function(){r.fit()})},[w,C,z])},Z=()=>{const[w,C]=k.useState(!1),[z,d]=k.useState(!1),[o,h]=k.useState(!0);k.useEffect(()=>{A(),P(),F()},[]),R();const u=()=>{C(!w)},p=()=>{d(!z)},f=()=>{h(!o)};return t.jsxs(t.Fragment,{children:[t.jsx("title",{children:"Vẽ đồ thị"}),t.jsxs("div",{className:"fade-in",children:[t.jsx(K,{activePage:"vedothi",className:"bg-transparent"}),t.jsxs("main",{id:"vedothi",children:[t.jsxs("div",{id:"controlsform",className:"container",children:[t.jsx("h2",{children:"Vẽ đồ thị"}),t.jsxs("div",{id:"graphOption",children:[t.jsxs("label",{className:"switch",children:["Có trọng số",t.jsx("input",{type:"checkbox",id:"isWeightedGraph",name:"isWeightedGraph",checked:w,onChange:u}),t.jsx("span",{className:"slider"})]}),t.jsxs("label",{className:"switch",children:["Có hướng",t.jsx("input",{type:"checkbox",id:"directed",name:"directed",checked:z,onChange:p}),t.jsx("span",{className:"slider"})]}),t.jsxs("label",{className:"switch",children:["Vật lý",t.jsx("input",{type:"checkbox",id:"physics",name:"physics",checked:o,onChange:f}),t.jsx("span",{className:"slider"})]})]}),t.jsxs("div",{className:"guild",children:[t.jsx("h3",{children:"Hướng dẫn"}),t.jsxs("ul",{children:[t.jsx("li",{children:"Đúp chuột để tạo một nút mới"}),t.jsx("li",{children:"Ấn giữ phím shift và chọn 2 đỉnh bất kì để tạo cung nối liền 2 đỉnh đó"}),t.jsx("li",{children:"Nếu giữ phím shift và đúp 2 lần vào một đỉnh sẽ tạo khuyên"}),t.jsx("li",{children:"Ctrl+Z để quay lại bước trước đó"}),t.jsx("li",{children:"Ctrl+Y để làm lại bước trước đó"}),t.jsx("li",{children:"Nhấp vào cạnh để có thể điền trọng số"})]})]})]}),t.jsxs("div",{className:"graph-container container",children:[t.jsx("div",{id:"mynetwork"}),t.jsx("button",{id:"zoomExtendsButton",children:t.jsx("img",{src:H,alt:"",width:40})})]})]})]})]})};export{Z as default};
